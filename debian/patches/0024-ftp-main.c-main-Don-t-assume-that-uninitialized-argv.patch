From fe0bc1aeccabda28908c9ae2a3e494ca8ecb59c3 Mon Sep 17 00:00:00 2001
From: "Alfred M. Szmidt" <ams@gnu.org>
Date: Thu, 22 Jun 2017 10:12:10 +0200
Subject: [PATCH 24/64] ftp/main.c (main): Don't assume that uninitialized
 argv[argv] is NULL.

---
 ChangeLog  | 5 +++++
 ftp/main.c | 7 +++----
 2 files changed, 8 insertions(+), 4 deletions(-)

diff --git a/ChangeLog b/ChangeLog
index fe8414ef..01b48062 100644
--- a/ChangeLog
+++ b/ChangeLog
@@ -1,3 +1,8 @@
+2017-06-22  Omer Anson <oaanson@gmail.com>  (tiny change)
+
+	* ftp/main.c (main): Don't assume that uninitialized argv[argv] is
+	NULL.
+
 2017-02-27  Mats Erik Andersson  <gnu@gisladisker.se>
 
 	telnetd: Portability of TTY termcap to Solaris systems.
diff --git a/ftp/main.c b/ftp/main.c
index 4ccb079d..0ff6e044 100644
--- a/ftp/main.c
+++ b/ftp/main.c
@@ -286,16 +286,15 @@ main (int argc, char *argv[])
   if (argc > 0)
     {
       char *xargv[5];
+      int i;
 
       if (setjmp (toplevel))
 	exit (EXIT_SUCCESS);
       signal (SIGINT, intr);
       signal (SIGPIPE, lostpeer);
       xargv[0] = program_invocation_name;
-      xargv[1] = argv[0];
-      xargv[2] = argv[1];
-      xargv[3] = argv[2];
-      xargv[4] = NULL;
+      for (i = 0; i < argc && i < 3; i++)
+	xargv[i + 1] = argv[i];
       setpeer (argc + 1, xargv);
     }
   top = setjmp (toplevel) == 0;
-- 
2.28.0.163.g6104cc2f0b6

